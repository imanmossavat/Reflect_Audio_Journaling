{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///Users/imanm/Library/CloudStorage/OneDrive-Office365Fontys/Documenten/Research/Journaling/reflect%20repo/Reflect_Audio_Journaling/Frontend/lib/api.ts"],"sourcesContent":["import { RecordingData, PiiHit } from \"./recording.types\";\n\nexport const API = \"http://127.0.0.1:8000\";\n\n// --- Types for specific API payloads ---\nexport type RecordingListItem = {\n  recording_id: string;\n  title: string | null;\n  created_at: string | null;\n  has_audio: boolean;\n  transcripts: { original: boolean; edited: boolean; redacted: boolean };\n  latest_transcript_version: string | null;\n  search_text: string | null;\n  tags: string[];\n  duration: number;\n};\n\nexport type SemanticHit = {\n  recording_id: string;\n  segment_id: number;\n  score: number;\n  label: string;\n  text: string;\n  start_s: number | null;\n  end_s: number | null;\n};\n\n// --- API Client ---\n\nexport const Api = {\n  // Recordings\n  listRecordings: async (): Promise<RecordingListItem[]> => {\n    const res = await fetch(`${API}/api/recordings`, { cache: \"no-store\" });\n    if (!res.ok) throw new Error(\"Failed to fetch recordings\");\n    return res.json();\n  },\n\n  getRecording: async (id: string): Promise<RecordingData> => {\n    const res = await fetch(`${API}/api/recordings/${id}`, { cache: \"no-store\" });\n    if (res.status === 404) return {} as RecordingData; // Handle not found gracefully in UI\n    if (!res.ok) throw new Error(\"Failed to fetch recording\");\n    return res.json();\n  },\n\n  updateRecordingMeta: async (id: string, payload: { title?: string; tags?: string[] }) => {\n    const res = await fetch(`${API}/api/recordings/${id}/meta`, {\n      method: \"PATCH\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(payload),\n    });\n    if (!res.ok) throw new Error(\"Failed to update metadata\");\n    return res.json();\n  },\n\n  deleteRecording: async (id: string) => {\n    const res = await fetch(`${API}/api/recordings/${id}`, { method: \"DELETE\" });\n    if (!res.ok) throw new Error(\"Failed to delete recording\");\n    return res.json();\n  },\n\n  deleteAudio: async (id: string) => {\n    const res = await fetch(`${API}/api/recordings/${id}/audio`, { method: \"DELETE\" });\n    if (!res.ok) throw new Error(\"Failed to delete audio\");\n    return res.json();\n  },\n\n  deleteTranscripts: async (id: string) => {\n    const res = await fetch(`${API}/api/recordings/${id}/transcript?version=all`, { method: \"DELETE\" });\n    if (!res.ok) throw new Error(\"Failed to delete transcripts\");\n    return res.json();\n  },\n\n  deleteSegments: async (id: string) => {\n    const res = await fetch(`${API}/api/recordings/${id}/segments`, { method: \"DELETE\" });\n    if (!res.ok) throw new Error(\"Failed to delete segments\");\n    return res.json();\n  },\n\n  // Audio & Uploads\n  uploadAudio: async (formData: FormData): Promise<{ recording_id: string }> => {\n    const res = await fetch(`${API}/api/recordings/upload`, {\n      method: \"POST\",\n      body: formData,\n    });\n    if (!res.ok) {\n      const err = await res.json().catch(() => ({}));\n      throw new Error(err?.detail || \"Upload failed\");\n    }\n    return res.json();\n  },\n\n  createTextEntry: async (text: string): Promise<{ recording_id: string }> => {\n    const res = await fetch(`${API}/api/recordings/text`, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({ text }),\n    });\n    if (!res.ok) {\n      const err = await res.json().catch(() => ({}));\n      throw new Error(err?.detail || \"Failed to create text entry\");\n    }\n    return res.json();\n  },\n\n  // Transcripts & Processing\n  getTranscript: async (id: string, version: \"original\" | \"edited\" | \"redacted\" = \"original\") => {\n    const res = await fetch(`${API}/api/recordings/${id}/transcript?version=${version}`);\n    if (!res.ok) return { text: \"\" };\n    return res.json(); // returns { text: \"...\" }\n  },\n\n  saveEditedTranscript: async (id: string, text: string) => {\n    const res = await fetch(`${API}/api/recordings/${id}/transcript/edited`, {\n      method: \"PUT\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({ text }),\n    });\n    if (!res.ok) throw new Error(\"Failed to save transcript\");\n    return res.json();\n  },\n\n  finalizeRecording: async (id: string, editedTranscript: string) => {\n    const formData = new FormData();\n    formData.append(\"recording_id\", id);\n    formData.append(\"edited_transcript\", editedTranscript);\n\n    const res = await fetch(`${API}/api/recordings/finalize`, {\n      method: \"POST\",\n      body: formData,\n    });\n    if (!res.ok) throw new Error(\"Processing failed\");\n    return res.json();\n  },\n\n  syncPii: async (id: string, findings: PiiHit[]) => {\n    const res = await fetch(`${API}/api/recordings/${id}/pii`, {\n      method: \"PUT\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({ findings }),\n    });\n    if (!res.ok) throw new Error(\"Failed to sync PII\");\n    return res.json();\n  },\n\n\n  // Settings\n  getSettings: async () => {\n    const res = await fetch(`${API}/api/settings`);\n    if (!res.ok) throw new Error(\"Failed to fetch settings\");\n    return res.json();\n  },\n\n  updateSettings: async (settings: object, restart = false) => {\n    const payload = { ...settings, RESTART_REQUIRED: restart };\n    const res = await fetch(`${API}/api/settings/update`, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(payload),\n    });\n    if (!res.ok) throw new Error(\"Failed to update settings\");\n    return res.json();\n  },\n\n  resetSettings: async () => {\n    const res = await fetch(`${API}/api/settings/reset`, { method: \"POST\" });\n    if (!res.ok) throw new Error(\"Failed to reset settings\");\n    return res.json();\n  },\n\n  openFolder: async (path: string) => {\n    const res = await fetch(`${API}/api/settings/open-folder`, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({ path }),\n    });\n    if (!res.ok) throw new Error(\"Failed to open folder\");\n    return res.json();\n  },\n\n  // AI Tools\n  semanticSearch: async (query: string): Promise<SemanticHit[]> => {\n    const res = await fetch(`${API}/api/search/semantic`, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({ query }),\n    });\n    if (!res.ok) return [];\n    const data = await res.json();\n    return data.hits || [];\n  }\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 207, "column": 0}, "map": {"version":3,"sources":["file:///Users/imanm/Library/CloudStorage/OneDrive-Office365Fontys/Documenten/Research/Journaling/reflect%20repo/Reflect_Audio_Journaling/Frontend/context/ServerStatusContext.tsx"],"sourcesContent":["\"use client\";\n\nimport { createContext, useContext, useEffect, useState, useCallback, ReactNode } from \"react\";\nimport { API } from \"@/lib/api\";\n\ninterface ServerStatusContextType {\n    isServerUp: boolean | null;\n    isConfigured: boolean | null;\n    isChecking: boolean;\n    checkStatus: () => Promise<void>;\n}\n\nconst ServerStatusContext = createContext<ServerStatusContextType | undefined>(undefined);\n\nexport function ServerStatusProvider({ children }: { children: ReactNode }) {\n    const [isServerUp, setIsServerUp] = useState<boolean | null>(null);\n    const [isConfigured, setIsConfigured] = useState<boolean | null>(null);\n    const [isChecking, setIsChecking] = useState(false);\n\n    const checkStatus = useCallback(async () => {\n        setIsChecking(true);\n        try {\n            // Check setup status first\n            const res = await fetch(`${API}/api/setup/status`, {\n                signal: AbortSignal.timeout(3000)\n            });\n            if (res.ok) {\n                const data = await res.json();\n                setIsServerUp(true);\n                setIsConfigured(data.is_configured);\n            } else {\n                setIsServerUp(false);\n                setIsConfigured(null);\n            }\n        } catch (e) {\n            setIsServerUp(false);\n            setIsConfigured(null);\n        } finally {\n            setIsChecking(false);\n        }\n    }, []);\n\n    useEffect(() => {\n        checkStatus();\n        const interval = setInterval(checkStatus, 10000); // Check every 10s\n        return () => clearInterval(interval);\n    }, [checkStatus]);\n\n    return (\n        <ServerStatusContext.Provider value={{ isServerUp, isConfigured, isChecking, checkStatus }}>\n            {children}\n        </ServerStatusContext.Provider>\n    );\n}\n\nexport function useServerStatus() {\n    const context = useContext(ServerStatusContext);\n    if (context === undefined) {\n        throw new Error(\"useServerStatus must be used within a ServerStatusProvider\");\n    }\n    return context;\n}\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AAHA;;;;AAYA,MAAM,oCAAsB,IAAA,sNAAa,EAAsC;AAExE,SAAS,qBAAqB,EAAE,QAAQ,EAA2B;IACtE,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAiB;IAC7D,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,iNAAQ,EAAiB;IACjE,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAC;IAE7C,MAAM,cAAc,IAAA,oNAAW,EAAC;QAC5B,cAAc;QACd,IAAI;YACA,2BAA2B;YAC3B,MAAM,MAAM,MAAM,MAAM,GAAG,iHAAG,CAAC,iBAAiB,CAAC,EAAE;gBAC/C,QAAQ,YAAY,OAAO,CAAC;YAChC;YACA,IAAI,IAAI,EAAE,EAAE;gBACR,MAAM,OAAO,MAAM,IAAI,IAAI;gBAC3B,cAAc;gBACd,gBAAgB,KAAK,aAAa;YACtC,OAAO;gBACH,cAAc;gBACd,gBAAgB;YACpB;QACJ,EAAE,OAAO,GAAG;YACR,cAAc;YACd,gBAAgB;QACpB,SAAU;YACN,cAAc;QAClB;IACJ,GAAG,EAAE;IAEL,IAAA,kNAAS,EAAC;QACN;QACA,MAAM,WAAW,YAAY,aAAa,QAAQ,kBAAkB;QACpE,OAAO,IAAM,cAAc;IAC/B,GAAG;QAAC;KAAY;IAEhB,qBACI,8OAAC,oBAAoB,QAAQ;QAAC,OAAO;YAAE;YAAY;YAAc;YAAY;QAAY;kBACpF;;;;;;AAGb;AAEO,SAAS;IACZ,MAAM,UAAU,IAAA,mNAAU,EAAC;IAC3B,IAAI,YAAY,WAAW;QACvB,MAAM,IAAI,MAAM;IACpB;IACA,OAAO;AACX"}},
    {"offset": {"line": 297, "column": 0}, "map": {"version":3,"sources":["file:///Users/imanm/Library/CloudStorage/OneDrive-Office365Fontys/Documenten/Research/Journaling/reflect%20repo/Reflect_Audio_Journaling/Frontend/components/shared/SetupGuard.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect } from \"react\";\nimport { useRouter, usePathname } from \"next/navigation\";\nimport { useServerStatus } from \"@/context/ServerStatusContext\";\n\nexport function SetupGuard({ children }: { children: React.ReactNode }) {\n    const { isConfigured, isServerUp } = useServerStatus();\n    const router = useRouter();\n    const pathname = usePathname();\n\n    useEffect(() => {\n        // If we are on the setup page, don't redirect away unless configured\n        if (pathname === \"/setup\") {\n            if (isConfigured === true && !window.location.search.includes(\"reconfigure=true\")) {\n                router.push(\"/\");\n            }\n            return;\n        }\n\n        // If server is up but not configured, redirect to setup\n        if (isServerUp && isConfigured === false) {\n            router.push(\"/setup\");\n        }\n    }, [isConfigured, isServerUp, pathname, router]);\n\n    return <>{children}</>;\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAMO,SAAS,WAAW,EAAE,QAAQ,EAAiC;IAClE,MAAM,EAAE,YAAY,EAAE,UAAU,EAAE,GAAG,IAAA,kJAAe;IACpD,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,WAAW,IAAA,iJAAW;IAE5B,IAAA,kNAAS,EAAC;QACN,qEAAqE;QACrE,IAAI,aAAa,UAAU;YACvB,IAAI,iBAAiB,QAAQ,CAAC,OAAO,QAAQ,CAAC,MAAM,CAAC,QAAQ,CAAC,qBAAqB;gBAC/E,OAAO,IAAI,CAAC;YAChB;YACA;QACJ;QAEA,wDAAwD;QACxD,IAAI,cAAc,iBAAiB,OAAO;YACtC,OAAO,IAAI,CAAC;QAChB;IACJ,GAAG;QAAC;QAAc;QAAY;QAAU;KAAO;IAE/C,qBAAO;kBAAG;;AACd"}}]
}